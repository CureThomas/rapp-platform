<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>RAPP Platform Wiki: (novice) Create-a-remote-robotic-application-for-NAO-in-Python-(novice)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="RAPP_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">RAPP Platform Wiki
   &#160;<span id="projectnumber">v0.6.0</span>
   </div>
   <div id="projectbrief">RAPP Platform is a collection of ROS nodes and back-end processes that aim to deliver ready-to-use generic services to robots</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_rapp-platform_8wiki_Create-a-remote-robotic-application-for-NAO-in-Python-.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">(novice) Create-a-remote-robotic-application-for-NAO-in-Python-(novice) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial has a goal to introduce a novice programmer (who is not necessarily a roboticist) into the RApps concept (where RApps stands for Robotic Applications). Here, a simple application will be created for the NAO robot using the Python programming language. This application will be executed remotely in a PC (and not in the actual robot), in order to avoid any advanced in-robot modifications.</p>
<p>As always, the preparation steps are much more than the actual robotic application programming, so lets begin with this.</p>
<h2>Preparation steps</h2>
<p>For this tutorial we will use the following tools:</p>
<ul>
<li>the NaoQi Python libraries v2.1.4</li>
<li>the <code>rapp-robots-api</code> Github repository</li>
</ul>
<p>Of course the standard prerequisites are a functional installation of Ubuntu 14.04, an editor and a terminal.</p>
<h4>NaoQi Python libraries setup</h4>
<p>Since the application is going to be remotely deployed (not directly in the robot), the NaoQi Python libraries are needed in order to achieve communication from the PC to the NAO robot. If you are the owner of a NAO robot, you can download this package following <a href="http://doc.aldebaran.com/2-1/dev/python/install_guide.html#linux">these instructions</a>. For this tutorial we will download the <a href="https://community.aldebaran.com/en/dl/ZmllbGRfY29sbGVjdGlvbl9pdGVtLTc4NS1maWVsZF9zb2Z0X2RsX2V4dGVybmFsX2xpbmstMC03ZWY1ZjE%3D?width=500&amp;height=auto">Python 2.7 SDK 2.1.4 Linux 64</a> from Aldebaran's <a href="https://community.aldebaran.com/en/resources/software/language/en-gb">software resources webpage</a>, after logging in with our credentials.</p>
<p>The downloaded file is <code>pynaoqi-python2.7-2.1.4.13-linux64.tar.gz</code> and lets assume that it was downloaded in <code>$HOME</code>. Next, we create a dedicated folder for our project, move the file there and untar it:</p>
<p>``` cd ~ mkdir rapp_nao mv ~/pynaoqi-python2.7-2.1.4.13-linux64.tar.gz ~/rapp_nao cd ~/rapp_nao tar -xvf pynaoqi-python2.7-2.1.4.13-linux64.tar.gz ```</p>
<p>Next, the PYTHONPATH environmental variable must be updated with the location of the NaoQi libraries:</p>
<p>``` echo 'export PYTHONPATH=$PYTHONPATH:~/rapp_nao/pynaoqi-python2.7-2.1.4.13-linux64' &gt;&gt; ~/.bashrc source ~/.bashrc ```</p>
<p>Now, the NaoQi is ready for utilization. The next step is to setup the <code>rapp-robots-api</code> Python libraries.</p>
<h4>RAPP Robots API libraries setup</h4>
<p>The first step is to clone the appropriate GitHub repository:</p>
<p>``` cd ~/rapp_nao git clone <a href="https://github.com/rapp-project/rapp-robots-api.git">https://github.com/rapp-project/rapp-robots-api.git</a> ```</p>
<p>Similarly to the NaoQi Python libraries, the <code>PYTHONPATH</code> variable has to be updated:</p>
<p>``` echo 'export PYTHONPATH=$PYTHONPATH:~/rapp_nao/rapp-robots-api/python/abstract_classes' &gt;&gt; ~/.bashrc echo 'export PYTHONPATH=$PYTHONPATH:~/rapp_nao/rapp-robots-api/python/implementations/nao_v4_naoqi2.1.4' &gt;&gt; ~/.bashrc source ~/.bashrc ```</p>
<p>The last step to configure the <code>rapp-robots-api</code> is to declare the NAO IP. It should be stated that the PC and NAO <b>must</b> be in the same LAN. In order to find the NAO IP just press once its chest button while in operation and the robot will dictate it.</p>
<p>The IP must be declared in the first line of <a href="https://github.com/rapp-project/rapp-robots-api/blob/master/python/implementations/nao_v4_naoqi2.1.4/nao_connectivity">this</a> file, thus if the IP is <code>192.168.0.101</code> the <code>nao_connectivity</code> file located under <code>~/rapp_nao/rapp-robots-api/python/implementations/nao_v4_naoqi2.1.4/nao_connectivity</code> should contain:</p>
<p>``` 192.168.0.101 9559 ```</p>
<p>Now all tools are in place to write our simple NAO Python application.</p>
<h2>Writing a simple application</h2>
<p>Let's create a Python file for our application and give it execution rights:</p>
<p>``` cd ~/rapp_nao mkdir rapps &amp;&amp; cd rapps touch simple_app.py chmod +x simple_app.py ```</p>
<p>The first step is to check if everything is in place. Write the following in the <code>simple_app.py</code> file:</p>
<p>```python #!/usr/bin/env python from rapp_robot_api import RappRobot rh = RappRobot() rh.audio.speak("Hello there!") ```</p>
<p>If everything was set-up correctly the NAO robot should talk and say "Hello there!" to you. If not, one of the aforementioned instructions was not performed correctly (or if it they all were, please submit a bug to correct this tutorial!).</p>
<p>Now for the real application, you can use any of the documented API calls that exist <a href="https://github.com/rapp-project/rapp-robots-api/tree/master/python">here</a>. Insert the following in the <code>simple_app.py</code> file:</p>
<p>```python #!/usr/bin/env python</p>
<h1>Import the RAPP Robot API</h1>
<p>from rapp_robot_api import RappRobot </p>
<h1>Create an object in order to call the desired functions</h1>
<p>rh = RappRobot()</p>
<h1>Adjust the NAO master volume and ask for instructions. The valid commands are 'stand' and 'sit' and NAO waits for 5 seconds</h1>
<p>rh.audio.setVolume(50) rh.audio.speak("Hello there! What do you want me to do? I can sit or get up.") res = rh.audio.speechDetection(['sit', 'get up'], 5) print res word = '' inner_word = '' if res['error'] == None: word = res['word']</p>
<h1>Check which command was dictated by the human</h1>
<p>if word == 'sit': </p>
<h1>The motors must be enabled for NAO to move</h1>
<p>rh.motion.enableMotors() </p>
<h1>NAO sits with 75% of its maximum speed</h1>
<p>rh.humanoid_motion.goToPosture('Sit', 0.75) elif word == 'get up': </p>
<h1>The motors must be enabled for NAO to move</h1>
<p>rh.motion.enableMotors() </p>
<h1>NAO stands with 75% of its maximum speed</h1>
<p>rh.humanoid_motion.goToPosture('Stand', 0.75) else: </p>
<h1>No command was dictated or the command was not understood</h1>
<p>pass</p>
<h1>Ask the human what movement to do: move the hands or the head?</h1>
<p>rh.audio.speak("Do you want me to move my arms or my head?") res = rh.audio.speechDetection(['arms', 'head'], 5) print res if res['error'] == None: word = res['word']</p>
<p>rh.motion.enableMotors() if word == 'arms': rh.audio.speak("Do you want me to open the left or right hand?") res = rh.audio.speechDetection(['left', 'right'], 5) print res if res['error'] == None: inner_word = res['word'] if inner_word == 'left': rh.humanoid_motion.openHand('Left') elif inner_word == 'right': rh.humanoid_motion.openHand('Right') else: pass</p>
<p>rh.audio.speak("I will close my hands now") rh.humanoid_motion.closeHand('Right') rh.humanoid_motion.closeHand('Left') elif word == 'head': rh.audio.speak("Do you want me to turn my head left or right?") res = rh.audio.speechDetection(['left', 'right'], 5) print res if res['error'] == None: inner_word = res['word'] </p>
<h1>The head moves by 0.4 rads left or right with 50% of its maximum speed</h1>
<p>if inner_word == 'left': rh.humanoid_motion.setJointAngles(['HeadYaw'], [0.4], 0.5) elif inner_word == 'right': rh.humanoid_motion.setJointAngles(['HeadYaw'], [-0.4], 0.5) else: pass</p>
<p>rh.audio.speak("I will look straight now") rh.humanoid_motion.setJointAngles(['HeadYaw'], [0], 0.5) else: pass</p>
<p>rh.audio.speak("And now I will sit down and sleep!") rh.humanoid_motion.goToPosture('Sit', 0.7) rh.motion.disableMotors() ```</p>
<p>As you may have noticed the API calls are robot-agnostic, meaning that the developer (you) can create applications without having to specify on which robot they will be executed. If a specific function is not implemented in a robot that will execute this application, the specific command will simply have no effect.</p>
<p>Finally, the last step is to execute the RApp:</p>
<p>``` python ~/rapp_nao/rapps/simple_app.py ```</p>
<p>This application can be found <a href="https://github.com/rapp-project/rapps-nao/tree/master/1.move_by_speech-easy">here</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Jul 29 2016 18:44:08 for RAPP Platform Wiki by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
