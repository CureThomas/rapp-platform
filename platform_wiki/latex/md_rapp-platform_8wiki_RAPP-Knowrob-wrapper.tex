\#\-Methodology

The R\-A\-P\-P Knowrob wrapper R\-O\-S node is needed to expose specific services to the other R\-O\-S nodes and R\-P\-Ss (similarly to the My\-S\-Q\-L wrapper concept). In our implementation, the pure Know\-Rob ontology was enhanced after the insertion of extra classes derived from the Open\-A\-A\-L ontology, as well as others needed to implement the desired R\-Apps.

The services of the R\-A\-P\-P Knowrob wrapper are detailed below.

\#\-R\-O\-S Services Each service is analyzed below.

\subsection*{Subclasses of}

This service was created in order to return the subclasses of a specific ontology class. Apart from the basic functionality, one can perform recursive search in the ontology and not just in the classes’ immediate lower level connections.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/subclasses\-\_\-of}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \section*{The class whose subclasses we want}

string ontology\-\_\-class \section*{True if the query is recursive}

\subsection*{bool recursive }

\section*{Container for the subclasses}

string\mbox{[}\mbox{]} results \section*{Possible error}

string error \section*{true if successful}

bool success ```

\subsection*{Superclasses of}

This service was created in order to return the superclasses of a specific ontology class. Apart from the basic functionality, one can perform recursive search in the ontology and not just in the classes’ immediate higher level connections.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/superclasses\-\_\-of}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \section*{The class whose superclasses we want}

string ontology\-\_\-class \section*{True if the query is recursive}

\subsection*{bool recursive }

\section*{Container for the superclasses}

string\mbox{[}\mbox{]} results \section*{Possible error}

string error \section*{true if successful}

bool success ```

\subsection*{Is sub-\/super-\/class of}

This service was created in order to investigate two classes’ semantic relations. Apart from the basic functionality, one can perform recursive search in the ontology and not just in the classes’ immediate higher or lower level connections.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/is\-\_\-subsuperclass\-\_\-of}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \section*{The parent class}

string parent\-\_\-class \section*{The child class}

string child\-\_\-class \section*{True if the query is recursive}

\subsection*{bool recursive }

\section*{True if the semantic condition applies}

bool result \section*{Possible error}

string error \section*{true if successful}

bool success ```

\subsection*{Create instance}

This service was created in order to create an instance related to a specific ontology class. One can also store a file and comments. This service is not public but it is employed from the R\-I\-C nodes. Ownership of the new instance is assigned to the provided user which is an instance of the class Person within the ontology. The assignment involves setting an ontology attribute. The username provided in the input is the username of the user in the My\-S\-Q\-L database and not the name of the user’s instance in the ontology. The second is also stored within the My\-S\-Q\-L database the service acquires it by querying the My\-S\-Q\-L database (with the username as input) through the My\-S\-Q\-L wrapper. In case no ontology instance name (alias) is defined a new one is created utilizing the Create ontology alias service described below and the Ontology and My\-S\-Q\-L database are updated accordingly.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/create\-\_\-instance}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \section*{The user to whom the instance belongs}

string username \section*{The instance’s ontology class}

string ontology\-\_\-class \section*{A file url (if needed)}

string file\-\_\-url \section*{Comments (if needed)}

\subsection*{string comments }

\section*{A unique id}

string instance\-\_\-name \section*{Possible error}

string error \section*{true if successful}

bool success ```

\subsection*{Create ontology alias}

This service was created in order to create an alias for a user within the ontology. A user ontology alias is basically an instance of the class Person that exists within the ontology. The user’s ontology alias is stored within the My\-S\-Q\-L database in the respective column of the table User. This service accepts the My\-S\-Q\-L username of the user and performs a check by querying the My\-S\-Q\-L database in order to identify if an ontology alias has already been defined. If that is the case it simply returns that ontology alias. If not, it creates the ontology alias instance within the ontology, stores this information in the My\-S\-Q\-L database and finally it returns the newly created user ontology alias. In the case that a new ontology alias is created both the ontology and the My\-S\-Q\-L need to be updated. The service ensures that either both are updated in tandem or in case one fails no modifications take place in the other. This is critical to preserving proper synchronization between the My\-S\-Q\-L database and the ontology.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/create\-\_\-ontology\-\_\-alias}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \section*{The user to whom the instance belongs}

\subsection*{string username }

\section*{A unique id}

string ontology\-\_\-alias \section*{Possible error}

string error \section*{true if successful}

bool success ```

\subsection*{User instances of class}

This service allows an M\-L algorithm to retrieve user-\/specific information in order to compute and extract personalized data. This service is not exposed via a H\-O\-P service, but is employed internally by other R\-I\-C nodes. It returns all the ontology instances that are assigned to the ontology alias of the provided user. The ontology alias is acquired again by querying the My\-S\-Q\-L database.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/user\-\_\-instances\-\_\-of\-\_\-class}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \section*{The user whose instances must be returned}

string username \section*{The ontology class whose instances we desire}

\subsection*{string ontology\-\_\-class }

\section*{The instances}

String\mbox{[}\mbox{]} results \section*{Possible error}

string error \section*{true if successful}

bool success ```

\subsection*{Load / Dump ontology}

Since the Know\-Rob ontology framework does not provide online storage functionality, the ontology (along with the new information) must be stored in predefined time slots. This way, if a system crash occurs, the stored data won’t be lost but can be retrieved using the Load ontology R\-O\-S service. Both of these services have a common representation.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/load\-\_\-ontology} Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/dump\-\_\-ontology}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \section*{The file intended for loading or dumping the ontology}

\subsection*{string file\-\_\-url }

\section*{Possible error}

string error \section*{true if successful}

bool success ```

\subsection*{Create cognitive test}

This service creates a new cognitive exercise test in the ontology as an instance. This service is not exposed via a H\-O\-P service, but is employed internally by the R\-A\-P\-P Cognitive exercise system node. It accepts as input that parameters of the test which include its type, subtype, difficulty, variation and file path and returns the name of the ontology instance created.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/create\-\_\-cognitve\-\_\-tests}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \section*{The type of the test}

string test\-\_\-type \section*{The sub type of the test}

string test\-\_\-subtype \section*{The difficulty of the test}

int32 test\-\_\-difficulty \section*{The variation id of the test}

int32 test\-\_\-variation \section*{The file path where the test is located}

\subsection*{string test\-\_\-path }

\section*{The created test name}

string test\-\_\-name \section*{Possible error}

string error \section*{true if successful}

bool success ```

\subsection*{Return cognitive tests of type}

This service returns all cognitive tests of the given type that exist within the ontology. This service is not exposed via a H\-O\-P service, but is employed internally by the R\-A\-P\-P Cognitive exercise system node. It accepts as input the test type and returns the names of the tests and their parameters which include their subtypes, file paths, difficulties and variation ids.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/cognitive\-\_\-tests\-\_\-of\-\_\-type}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \section*{The type of the tests to be returned}

\subsection*{string test\-\_\-type }

\section*{The names of the tests}

string\mbox{[}\mbox{]} tests \section*{The subtype of the tests}

string\mbox{[}\mbox{]} subtype \section*{The file paths of the tests}

string\mbox{[}\mbox{]} file\-\_\-paths \section*{The difficulty of the tests}

string\mbox{[}\mbox{]} difficulty \section*{The variation of the tests}

string\mbox{[}\mbox{]} variation \section*{Possible error}

string error \section*{true if successful}

bool success ```

\subsection*{Record user cognitive test performance}

This service records the user’s (patient’s) performance on a given test at a given time. Performance is measured as integer value in the 0-\/100 range. This service is not exposed via a H\-O\-P service, but is employed internally by the R\-A\-P\-P Cognitive exercise system node.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/record\-\_\-user\-\_\-cognitive\-\_\-tests\-\_\-performance}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \section*{The name of the test}

string test \section*{The type of the test}

string test\-\_\-type \section*{The ontology alias of the patient who is taking the test}

string patient\-\_\-ontology\-\_\-alias \section*{The score the patient achieved in the test}

int32 score \section*{The timestamp at which the test was performed}

\subsection*{int32 timestamp }

\section*{The name of the cognitive test performance entry}

string cognitive\-\_\-test\-\_\-performance\-\_\-entry \section*{Possible error}

string error \section*{true if successful}

bool success ```

\subsection*{Return user cognitive test performance}

This service returns all the tests of the requested type that a specific user (patient) has undertaken along with the scores achieved, the time at which they were performed and the difficulty and variation ids of the tests. This service is not exposed via a H\-O\-P service, but is employed internally by the R\-A\-P\-P Cognitive exercise system node.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/user\-\_\-performance\-\_\-cognitve\-\_\-tests}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \section*{The ontology alias of the patient}

string ontology\-\_\-alias \section*{The type of the tests of interest}

\subsection*{string test\-\_\-type }

\section*{The names of the tests}

string\mbox{[}\mbox{]} tests \section*{The scores of the tests}

string\mbox{[}\mbox{]} scores \section*{The difficulty of the tests}

string\mbox{[}\mbox{]} difficulty \section*{The variation ids of the tests}

string\mbox{[}\mbox{]} variation \section*{The timestamps at which the tests were performed}

string\mbox{[}\mbox{]} timestamps \section*{Possible error}

string error \section*{true if successful}

bool success ```

\subsection*{Register image object to ontology}

This service will register an image, annotated by the rapp\-\_\-caffe\-\_\-wrapper to the ontology.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/register\-\_\-image\-\_\-object\-\_\-to\-\_\-ontology}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \#the user's ontology alias string user\-\_\-ontology\-\_\-alias \#the ontology class of the to be registered object string object\-\_\-ontology\-\_\-class \#the caffe class of the to be registered object string caffe\-\_\-class \#the path to the image representing the object string image\-\_\-path \#timestamp of the time of registration \subsection*{int32 timestamp }

\section*{The results of the query}

\#the name of the registered object entry string object\-\_\-entry \#possible error string error \#trace information string\mbox{[}\mbox{]} trace \#true if service call was successful bool success ```

\subsection*{Retract user ontology alias}

This service will remove the ontology alias of a user from the ontology.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/retract\-\_\-user\-\_\-ontology\-\_\-alias}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \#the user ontology alias to be retracted \subsection*{string ontology\-\_\-alias }

\section*{The results of the query}

\#possible error string error \#trace information string\mbox{[}\mbox{]} trace \#true if service call was successful bool success ```

\subsection*{Clear user cognitive test performance records}

This service will remove all cognitive test performance records of a user from the ontology.

Service U\-R\-L\-: {\ttfamily /rapp/rapp\-\_\-knowrob\-\_\-wrapper/clear\-\_\-user\-\_\-cognitive\-\_\-tests\-\_\-performance\-\_\-records}

Service type\-: ```bash \section*{Contains info about time and reference}

Header header \#the username of the user whose records will be cleared string username \#specify clearing the records of this test type onle \subsection*{string test\-\_\-type }

\section*{The results of the query}

\#possible error string error \#trace information string\mbox{[}\mbox{]} trace \#true if service call was successful bool success ```

\#\-Launchers

\subsection*{Standard launcher}

Launches the {\bfseries rapp\-\_\-knowrob\-\_\-wrapper} node and can be launched using ``` roslaunch rapp\-\_\-knowrob\-\_\-wrapper knowrob\-\_\-wrapper.\-launch ```

\#\-H\-O\-P services

\subsection*{Ontology-\/\-Sub\-Classes-\/\-Of}

\subsubsection*{Service-\/\-Url}

``` /hop/ontology\-\_\-subclasses\-\_\-of ```

\subsubsection*{Service request arguments}

```js \{ query\-: '' \} ```
\begin{DoxyItemize}
\item {\bfseries query} (String)\-: The query to the ontology database.
\end{DoxyItemize}

\subsubsection*{Service response}

application/json response.

```javascript \{ results\-: \mbox{[}\mbox{]}, error\-: '' \} ```


\begin{DoxyItemize}
\item {\bfseries results} (Array)\-: Query results.
\item {\bfseries error} (String)\-: Error message, if one occures.
\end{DoxyItemize}

```javascript \{ results\-: \mbox{[} '\href{http://knowrob.org/kb/knowrob.owl#Oven',}{\tt http\-://knowrob.\-org/kb/knowrob.\-owl\#\-Oven',} '\href{http://knowrob.org/kb/knowrob.owl#MicrowaveOven',}{\tt http\-://knowrob.\-org/kb/knowrob.\-owl\#\-Microwave\-Oven',} '\href{http://knowrob.org/kb/knowrob.owl#RegularOven',}{\tt http\-://knowrob.\-org/kb/knowrob.\-owl\#\-Regular\-Oven',} '\href{http://knowrob.org/kb/knowrob.owl#ToasterOven'}{\tt http\-://knowrob.\-org/kb/knowrob.\-owl\#\-Toaster\-Oven'}\mbox{]}, error\-: '' \} ```

\subsection*{Ontology-\/\-Super\-Classes-\/\-Of}

\subsubsection*{Service-\/\-Url}

``` /hop/ontology\-\_\-superclasses\-\_\-of ```

\subsubsection*{Service request arguments}

```js \{ query\-: '' \} ```


\begin{DoxyItemize}
\item {\bfseries query} (String)\-: The query to the ontology database.
\end{DoxyItemize}

\subsubsection*{Service response}

application/json response.

```javascript \{ results\-: \mbox{[}\mbox{]}, error\-: '' \} ```


\begin{DoxyItemize}
\item {\bfseries results} (Array)\-: Query results returned from ontology database.
\item {\bfseries error} (String)\-: Error message, if one occures.
\end{DoxyItemize}

\subsection*{Ontology-\/\-Is-\/\-Sub\-Super\-Class-\/\-Of}

\subsubsection*{Service-\/\-Url}

``` /hop/ontology\-\_\-is\-\_\-subsuperclass\-\_\-of ```

\subsubsection*{Service request arguments}

```js \{ parent\-\_\-class\-: '', child\-\_\-class\-: '', recursive\-: false \} ```


\begin{DoxyItemize}
\item {\bfseries parent\-\_\-class} (String)\-: The parent class name.
\item {\bfseries child\-\_\-class} (String) The child class name.
\item {\bfseries recursive} (Boolean)\-: Defines if a recursive procedure will be used (true/false).
\end{DoxyItemize}

\subsubsection*{Service response}

application/json response.

```javascript \{ result\-: true, error\-: '' \} ```


\begin{DoxyItemize}
\item {\bfseries result} (Boolena)\-: Success index on ontology-\/is-\/subsuperclass-\/of query.
\item {\bfseries error} (String)\-: Error message, if one occures. 
\end{DoxyItemize}